---
title: "Shader开发实战Chapter1"
math: true
date: 2025-03-13 10:30:00 +0800
categories: [渲染管线]
tags: [shader]
---
## 简单渲染管线

在讨论着色器细节之前，要先简单了解一下渲染管线的步骤
- 网格顶点数据
- 顶点着色器
- 形状装配
- 光栅化
- 片元着色器
- 片元处理

## 着色器是什么

着色器是在图形卡上执行的程序，和大多数程序不同它通常是在GPU上执行。这意味着着色器程序可以做到一些常规程序做不到的事情。就我们的目的而言要做到最终的事情就是控制部分渲染管线，以此来创建完全符合我们要求的游戏和程序

## GLSL的in关键字

in关键字是GLSL所特有的。它用于制定着色器希望从渲染管线的上一步接收那些数据；在顶点着色器中，渲染管线的上一步是GPU将应用程序提供的网格数据转换为可有顶点着色器以及管线后面阶段读取的格式

## GLSL的out关键字

与in关键字的含义相反由out声明的变量由当前着色器写入然后传递到管线的后期阶段，例如在片元着色器中使用了一个呕吐变量将每个片元的颜色传递给管线的后期阶段以便于这些颜色能够显示在屏幕上

## 归一化设备坐标

在GAMES101课程中在光栅化阶段有一个步骤就是将空间坐标变换到一个单位空间中，这里的归一化设备坐标的作用与之类似。为了让图像显示在不同像素显示器的相同位置需要我们对设备坐标进行归一在二维平面中是一个(-1，1)的的空间，原点坐标在屏幕中心

```
void mian()
{
	float x=(position.x/1024.0)*2.0-1.0;
	float y=(position.y/768.0)*2.0-1.0;
	gl_Position=vec4(x,y,0.0,1.0);
}
```

## 片元插值和统一变量

在绘制彩虹三角形的过程中我们只在三个顶点上定义了三个颜色，但呈现出来的却是一个彩色的三角形这其中的过程就是发生了片元插值；因为需要渲染这个三角形的“面”，所以GPU需要将那个顶点的输出数据发送到哪个片元，很显然GPU并不是只提取一个点而是将三个点的数据混合起来，这个过程就是片元插值(fragment interpolation)

使用顶点属性将数据导入到渲染管线的过程，并且修改顶点是一个非常缓慢的过程对于这样的情况我们需要使用统一变量(uniform  variable)，统一变量在网格中的每个顶点和片元上保持不变，无论他们在管现中何时被读取，也从不进行插值

